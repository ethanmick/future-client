// Generated by CoffeeScript 1.9.1
(function() {
  'use strict';
  var Client, DEFAULT_PORT, Q, SocketIO, request, uuid;

  Q = require('q');

  uuid = require('uuid').v4;

  request = require('request');

  SocketIO = require('socket.io-client');

  DEFAULT_PORT = 8124;

  Client = (function() {
    function Client(opts1) {
      var base, base1;
      this.opts = opts1 != null ? opts1 : {};
      if ((base = this.opts).port == null) {
        base.port = DEFAULT_PORT;
      }
      if ((base1 = this.opts).baseURL == null) {
        base1.baseURL = "http://localhost:" + this.opts.port;
      }
      this.socket = SocketIO("http://localhost:" + this.opts.port);
    }

    Client.prototype._send = function(opts) {
      var deferred;
      deferred = Q.defer();
      request(opts, function(err, res, body) {
        if (err) {
          return deferred.reject(err);
        }
        return deferred.resolve([body, res]);
      });
      return deferred.promise;
    };

    Client.prototype.schedule = function(task) {
      return this._send({
        method: 'POST',
        url: this.opts.baseURL + "/v1/task",
        json: true,
        body: task
      });
    };

    Client.prototype.get = function(name) {
      return this._send({
        url: this.opts.baseURL + "/v1/task/" + name,
        json: true
      });
    };

    Client.prototype["delete"] = function(name) {
      return this._send({
        method: 'DELETE',
        url: this.opts.baseURL + "/v1/task/" + name,
        json: true
      });
    };

    return Client;

  })();

  module.exports = Client;

}).call(this);
